<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>LUNAD</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%; }
</style>
</head>
<body>
<div id="map"></div>
<script>
	mapboxgl.accessToken = 'pk.eyJ1IjoiZml0emtlbmpvaG4iLCJhIjoiY2xxcWp2MWw1M3VwYjJtbm05dnc4eHY4MSJ9.kTofeMVuyWEX7X5NFU5kYg';
    const map = new mapboxgl.Map({
        container: 'map', // container ID
        // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
        style: 'mapbox://styles/mapbox/dark-v11', // style URL
        center: [123.740953,13.154756], // starting position [lng, lat]
        zoom: 13.5 // starting zoom
    });

    const geojson = {
        'type': 'FeatureCollection',
        'features': [
            {
                'type': 'Feature',
                'properties': {},
                'geometry': {
                    'coordinates': [
                    [
            123.7167569574899,
            13.14974652381835
          ],
          [
            123.71489305938582,
            13.14934924345998
          ],
          [
            123.71325694030571,
            13.148836352619313
          ],
          [
            123.71171302470952,
            13.148376752009725
          ],
          [
            123.71165702777125,
            13.148306643366652
          ],
          [
            123.71191301377735,
            13.148096317316387
          ],
          [
            123.71208100459216,
            13.147917150537978
          ],
          [
            123.71313694686535,
            13.148291063665312
          ],
          [
            123.71445397197948,
            13.148768468888193
          ],
          [
            123.7150600815861,
            13.148990594235741
          ],
          [
            123.71693706617407,
            13.148870011929091
          ],
          [
            123.7203527043477,
            13.147949776417605
          ],
          [
            123.72093926203212,
            13.14781650066827
          ],
          [
            123.72127551851395,
            13.147638396968276
          ],
          [
            123.72269629157051,
            13.146534108598814
          ],
          [
            123.72361409812561,
            13.145798809659325
          ],
          [
            123.72463731541922,
            13.145030879756732
          ],
          [
            123.72620417563536,
            13.143723214623975
          ],
          [
            123.72713615062167,
            13.143037783902997
          ],
          [
            123.72794450406747,
            13.142548891128925
          ],
          [
            123.7286483732882,
            13.142142708248386
          ],
          [
            123.72918279251132,
            13.141552472551524
          ],
          [
            123.72954776173702,
            13.141101861547568
          ],
          [
            123.73004959454045,
            13.140581436336888
          ],
          [
            123.73045366761045,
            13.140194290190308
          ],
          [
            123.73117057144646,
            13.139642129874659
          ],
          [
            123.73212366615945,
            13.139120938386569
          ],
          [
            123.73284056999552,
            13.138759176738901
          ],
          [
            123.73376602767337,
            13.138778216838347
          ],
          [
            123.73403323728496,
            13.138606855884774
          ],
          [
            123.73420920459091,
            13.138467228352951
          ],
          [
            123.73510207968059,
            13.13845453571625
          ],
          [
            123.73532366813777,
            13.138498962668805
          ],
          [
            123.73624260851045,
            13.138511656082557
          ],
          [
            123.73825905621942,
            13.138524349222394
          ],
          [
            123.74070956387487,
            13.138594162982756
          ],
          [
            123.74117227162048,
            13.138632236976875
          ],
          [
            123.743218706206,
            13.138943225253172
          ],
          [
            123.74407899080887,
            13.139120932662976
          ],
          [
            123.7447828600296,
            13.139216133008205
          ],
          [
            123.74528938493535,
            13.139486562398616
          ],
          [
            123.7461627041535,
            13.139924483028281
          ],
          [
            123.74691219452706,
            13.140381442851634
          ],
          [
            123.74802125241382,
            13.14093780449663
          ],
          [
            123.74897277932382,
            13.14143284222331
          ],
          [
            123.74940943893296,
            13.141585161322823
          ],
          [
            123.75055180991603,
            13.141874248412009
          ],
          [
            123.75142512913425,
            13.142280431736964
          ],
          [
            123.75188134066548,
            13.142635841595009
          ],
          [
            123.75224677778573,
            13.143043210136028
          ],
          [
            123.75268343739481,
            13.143722294270006
          ],
          [
            123.75307009853861,
            13.144555256951165
          ],
          [
            123.75324606584292,
            13.144606029349305
          ],
          [
            123.75344809957596,
            13.144974126333452
          ],
          [
            123.75369575726387,
            13.145735709894694
          ],
          [
            123.75363710149571,
            13.146097461257526
          ],
          [
            123.75344809957596,
            13.146535370089097
          ],
          [
            123.75407376110479,
            13.146611528066842
          ],
          [
            123.75383125545517,
            13.14747863694447
          ],
          [
            123.7536292189202,
            13.148094244221468
          ],
          [
            123.75344021699891,
            13.14881139301778
          ],
          [
            123.75315997337731,
            13.149764727620166
          ],
          [
            123.75303614453259,
            13.150196283500094
          ],
          [
            123.75198685801001,
            13.149942427192144
          ],
          [
            123.75171699185256,
            13.148802273556555
          ],
          [
            123.75172350916097,
            13.148497644224307
          ],
          [
            123.75221162635029,
            13.147899793016549
          ],
          [
            123.75272649364979,
            13.147265145812142
          ],
          [
            123.75275256288035,
            13.147176295072398
          ],
          [
            123.75251142249942,
            13.146820891791606
          ],
          [
            123.75243993443848,
            13.146673539180767
          ],
          [
            123.75259634982064,
            13.145969077161396
          ],
          [
            123.75294550394534,
            13.14506750246288
          ],
          [
            123.75303022894411,
            13.144635937559599
          ],
          [
            123.75299112509975,
            13.144369382387112
          ],
          [
            123.75278114746709,
            13.143982976381992
          ],
          [
            123.75239010901083,
            13.143316586134745
          ],
          [
            123.75203817542439,
            13.142859632689664
          ],
          [
            123.75166017158347,
            13.142516916362311
          ],
          [
            123.75139947928028,
            13.142301131762096
          ],
          [
            123.75046098698556,
            13.14186956199326
          ],
          [
            123.74962199996372,
            13.14168030839329
          ],
          [
            123.74900285574182,
            13.141496256207162
          ],
          [
            123.74830550382956,
            13.141159884614112
          ],
          [
            123.74739686430559,
            13.140674877232513
          ],
          [
            123.74657568354871,
            13.140236957941738
          ],
          [
            123.74572843356111,
            13.139729224452708
          ],
          [
            123.74469219951118,
            13.139202459502712
          ],
          [
            123.74299118222916,
            13.138948591819513
          ],
          [
            123.74125206822094,
            13.138678697384748
          ],
          [
            123.73883415422523,
            13.138539684592004
          ],
          [
            123.73672443070927,
            13.138544215432034
          ],
          [
            123.73559693649486,
            13.13849978848765
          ],
          [
            123.73514310223584,
            13.138488691524046
          ],
          [
            123.73508444646774,
            13.139193175017724
          ],
          [
            123.73412640225081,
            13.139193175017724
          ],
          [
            123.73399605609927,
            13.139072587896834
          ],
          [
            123.73396998686854,
            13.138710826177132
          ],
          [
            123.73372885391876,
            13.13880602674378
          ],
          [
            123.73297936354362,
            13.138812373442804
          ],
          [
            123.7327968789308,
            13.138812373442804
          ],
          [
            123.73159769433295,
            13.139440695828483
          ],
          [
            123.7304832417326,
            13.140208706776306
          ],
          [
            123.72995534517594,
            13.140703743338193
          ],
          [
            123.72917978557183,
            13.14157957947252
          ],
          [
            123.72880146682502,
            13.142024260382513
          ],
          [
            123.72777173222471,
            13.142690654139429
          ],
          [
            123.72668330801957,
            13.14340154273124
          ],
          [
            123.72567964264817,
            13.144182170855927
          ],
          [
            123.72456424781404,
            13.145125570589585
          ],
          [
            123.72385386128497,
            13.145684065087266
          ],
          [
            123.72280131066873,
            13.146490872675585
          ],
          [
            123.7222668914456,
            13.14692243431574
          ],
          [
            123.72128331030643,
            13.147670799021142
          ],
          [
            123.72091834108079,
            13.147873885969716
          ],
          [
            123.71975826032889,
            13.148153130248616
          ],
          [
            123.71751210146965,
            13.148784544115244
          ],
          [
            123.71690599186309,
            13.14893685865053
          ],
          [
            123.71677564571144,
            13.149749201242145
          ]

                    ],
                    'type': 'LineString'
                }
            }
        ]
    };

    map.on('load', () => {
        map.addSource('line', {
            type: 'geojson',
            data: geojson
        });

        // add a line layer without line-dasharray defined to fill the gaps in the dashed line
        map.addLayer({
            type: 'line',
            source: 'line',
            id: 'line-background',
            paint: {
                'line-color': 'yellow',
                'line-width': 6,
                'line-opacity': 0.4
            }
        });

        // add a line layer with line-dasharray set to the first value in dashArraySequence
        map.addLayer({
            type: 'line',
            source: 'line',
            id: 'line-dashed',
            paint: {
                'line-color': 'yellow',
                'line-width': 6,
                'line-dasharray': [0, 4, 3]
            }
        });

        // technique based on https://jsfiddle.net/2mws8y3q/
        // an array of valid line-dasharray values, specifying the lengths of the alternating dashes and gaps that form the dash pattern
        const dashArraySequence = [
            [0, 4, 3],
            [0.5, 4, 2.5],
            [1, 4, 2],
            [1.5, 4, 1.5],
            [2, 4, 1],
            [2.5, 4, 0.5],
            [3, 4, 0],
            [0, 0.5, 3, 3.5],
            [0, 1, 3, 3],
            [0, 1.5, 3, 2.5],
            [0, 2, 3, 2],
            [0, 2.5, 3, 1.5],
            [0, 3, 3, 1],
            [0, 3.5, 3, 0.5]
        ];

        let step = 0;

        function animateDashArray(timestamp) {
            // Update line-dasharray using the next value in dashArraySequence. The
            // divisor in the expression `timestamp / 50` controls the animation speed.
            const newStep = parseInt(
                (timestamp / 50) % dashArraySequence.length
            );

            if (newStep !== step) {
                map.setPaintProperty(
                    'line-dashed',
                    'line-dasharray',
                    dashArraySequence[step]
                );
                step = newStep;
            }

            // Request the next frame of the animation.
            requestAnimationFrame(animateDashArray);
        }

        // start the animation
        animateDashArray(0);
    });

        // Add geolocate control to the map.
        map.addControl(
        new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
},
        // When active the map will receive updates to the device's location as it changes.
        trackUserLocation: true,
        // Draw an arrow next to the location dot to indicate which direction the device is heading.
        showUserHeading: true
})
);
</script>

</body>
</html>